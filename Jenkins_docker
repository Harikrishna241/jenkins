pipeline{
    agent any
    environment { 
                AN_ACCESS_KEY = credentials('docker-cred')
    }
             
    stages{
        stage('checkout to dockerfile'){
            steps{
                checkout scmGit(branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/DevopsWorking/addressbook.git']])
                echo "checkout completed to clone the dockerfile"
            }
        }
        stage(' docker version'){
            steps{
                sh ' docker --version'
            }
        }
        stage('creating the image '){
            steps{
               sh 'docker build -t hkaranam241/addressbook:v1 .'
               echo "image creation completed"
            }
        }
        stage('Login to Docker Hub') {      	
            steps{                       	
            sh ' docker login -u $AN_ACCESS_KEY '                		
            echo 'Login Completed'      
        }           
}
        stage('pushing the image '){
            steps{
                sh ' docker push hkaranam241/addressbook:v1'
                echo 'Push Image Completed' 
            }
        }
    }
}